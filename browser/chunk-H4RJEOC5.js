import{b as C}from"./chunk-5P6WEIG4.js";import{a as E,b as p,c as k,d as G,e as x,f as g,h as T,i as R,j as L,m as N}from"./chunk-KDAZZI2D.js";import{D as S,o as P}from"./chunk-6AZ3IQKA.js";import"./chunk-OOTTVPT5.js";import"./chunk-GLXZBIO7.js";import{Cb as h,Eb as _,Jb as l,Lb as s,Na as i,W as v,Ya as y,lb as d,mb as m,qb as u,rb as r,sb as a,tb as c}from"./chunk-26VLXO62.js";import"./chunk-4CLCTAJ7.js";function F(t,o){t&1&&(r(0,"p"),s(1,"Email is required"),a())}function A(t,o){t&1&&(r(0,"p"),s(1,"Invalid email format (example@email.com)"),a())}function z(t,o){if(t&1&&(r(0,"div",9),d(1,F,2,0,"p")(2,A,2,0,"p"),a()),t&2){let n,e=_();i(),m((n=e.forgetPasswordGroup.get("email"))!=null&&n.getError("required")?1:(n=e.forgetPasswordGroup.get("email"))!=null&&n.getError("email")?2:-1)}}function D(t,o){t&1&&s(0," Sending... ")}function M(t,o){t&1&&s(0," Send ")}function V(t,o){t&1&&(r(0,"p"),s(1,"Code is required"),a())}function I(t,o){t&1&&(r(0,"p"),s(1,"Code must be at least 6 numbers"),a())}function j(t,o){if(t&1&&(r(0,"div",9),d(1,V,2,0,"p")(2,I,2,0,"p"),a()),t&2){let n,e=_();i(),m((n=e.verifyCodeGroup.get("resetCode"))!=null&&n.getError("required")?1:(n=e.verifyCodeGroup.get("resetCode"))!=null&&n.getError("minlength")?2:-1)}}function W(t,o){t&1&&s(0," Sending... ")}function Z(t,o){t&1&&s(0," Send ")}function $(t,o){t&1&&(r(0,"p"),s(1,"Password is required"),a())}function B(t,o){t&1&&(r(0,"p"),s(1,"Password must start with a capital letter first and have 5-11 letters or numbers"),a())}function H(t,o){if(t&1&&(r(0,"div",9),d(1,$,2,0,"p")(2,B,2,0,"p"),a()),t&2){let n,e=_();i(),m((n=e.setPasswordGroup.get("newPassword"))!=null&&n.getError("required")?1:(n=e.setPasswordGroup.get("newPassword"))!=null&&n.getError("pattern")?2:-1)}}function J(t,o){t&1&&s(0," Sending... ")}function K(t,o){t&1&&s(0," Send ")}var q=class t{step=1;isLoading=!1;toastr=v(S);authService=v(C);router=v(P);handleFPsubmit(){if(this.step===1){if(this.forgetPasswordGroup.invalid){this.forgetPasswordGroup.markAllAsTouched();return}this.setPasswordGroup.get("email")?.patchValue(this.forgetPasswordGroup.value.email||""),this.isLoading=!0,this.authService.forgetPassword({email:this.forgetPasswordGroup.value.email}).subscribe({next:o=>{this.toastr.success("Code sent to your Email","Success"),this.step++,this.isLoading=!1},error:o=>{let n=o?.error?.message||"No account found with this email.";this.toastr.error(n,"Error"),this.isLoading=!1}})}else if(this.step===2){if(this.verifyCodeGroup.invalid){this.verifyCodeGroup.markAllAsTouched();return}this.isLoading=!0,this.authService.verifyCode({resetCode:this.verifyCodeGroup.value.resetCode}).subscribe({next:o=>{this.isLoading=!1,this.toastr.success("Code is Correct","Success"),this.step++},error:o=>{let n=o?.error?.message||"Invalid verification code.";this.toastr.error(n,"Error"),this.isLoading=!1}})}}handleEnd(){if(this.setPasswordGroup.invalid){this.setPasswordGroup.markAllAsTouched();return}this.isLoading=!0,this.authService.resetPassword({email:this.setPasswordGroup.value.email,newPassword:this.setPasswordGroup.value.newPassword}).subscribe({next:o=>{this.isLoading=!1,this.toastr.success("Password reset successfully","Done"),localStorage.setItem("token",o.token),this.authService.decodedToken(o.token),this.router.navigate(["/"])},error:o=>{let n=o?.error?.message||"Wrong Password pattern.";this.toastr.error(n,"Error"),this.isLoading=!1}})}forgetPasswordGroup=new x({email:new g("",[p.required,p.email])});verifyCodeGroup=new x({resetCode:new g("",[p.required,p.minLength(6)])});setPasswordGroup=new x({email:new g("",[p.required,p.email]),newPassword:new g("",[p.required,p.pattern(/^[A-Z][a-z0-9]{5,11}$/),p.maxLength(12)])});static \u0275fac=function(n){return new(n||t)};static \u0275cmp=y({type:t,selectors:[["app-reset-password"]],decls:59,vars:37,consts:[[1,"py-10","h-screen","flex","items-center","justify-center",2,"background-image","url('/images/8.webp')","background-position","center","background-size","cover"],[1,"bg-white","rounded-lg","shadow-md","shadow-black","py-6","px-4","sm:px-6","md:px-8","w-11/12","sm:w-3/4","md:w-2/3","lg:w-1/2","xl:w-1/3","hidden"],[1,"flex","gap-4","mb-6"],[1,"w-1/3","h-2","bg-gray-400","rounded"],[1,"text-2xl","sm:text-3xl","md:text-4xl","text-main","text-center","mb-2.5"],[1,"text-sm","text-gray-500","text-center","mb-3.5"],[1,"max-w-md","mx-auto",3,"ngSubmit","formGroup"],[1,"relative","z-0","w-full","my-3","group"],["formControlName","email","type","email","name","floating_email","id","floating_email","placeholder"," ",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","dark:text-white","dark:border-gray-600","dark:focus:border-main","focus:outline-none","focus:ring-0","focus:border-main","peer"],[1,"p-4","my-2","text-sm","text-red-800","rounded-lg","bg-red-50","dark:bg-gray-800","dark:text-red-400"],["for","floating_email",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","dark:text-gray-400","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","rtl:peer-focus:left-auto","peer-focus:text-main","peer-focus:dark:text-main","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],["type","submit",1,"text-white","bg-main","hover:bg-transparent","hover:border","hover:border-main","hover:text-main","font-medium","rounded-lg","mt-2.5","text-sm","w-full","px-5","py-2.5","text-center","active:scale-95","transition-transform","duration-100","cursor-pointer","disabled:bg-gray-400","disabled:text-gray-200","disabled:border-gray-400","disabled:cursor-not-allowed","disabled:opacity-70",3,"disabled"],["formControlName","resetCode","type","text","name","floating_code","id","floating_code","placeholder"," ",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","dark:text-white","dark:border-gray-600","dark:focus:border-main","focus:outline-none","focus:ring-0","focus:border-main","peer"],["for","floating_code",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","dark:text-gray-400","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","rtl:peer-focus:left-auto","peer-focus:text-main","peer-focus:dark:text-main","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],[1,"relative","z-0","w-full","my-4","group"],["formControlName","email","type","email","name","floating_email","id","floating_email","placeholder"," ",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","dark:text-white","dark:border-gray-600","dark:focus:border-main","focus:outline-none","focus:ring-0","focus:border-main","peer",3,"readonly"],["formControlName","newPassword","type","password","name","floating_password","id","floating_password","placeholder"," ",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","dark:text-white","dark:border-gray-600","dark:focus:border-main","focus:outline-none","focus:ring-0","focus:border-main","peer"],["for","floating_password",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","dark:text-gray-400","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","rtl:peer-focus:left-auto","peer-focus:text-main","peer-focus:dark:text-main","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"]],template:function(n,e){if(n&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),c(3,"div",3)(4,"div",3)(5,"div",3),a(),r(6,"h1",4),s(7,"Forget Password"),a(),r(8,"p",5),s(9," Please fill in your email to send you the code. "),a(),r(10,"form",6),h("ngSubmit",function(){return e.handleFPsubmit()}),r(11,"div",7),c(12,"input",8),d(13,z,3,1,"div",9),r(14,"label",10),s(15,"Email address"),a()(),r(16,"button",11),d(17,D,1,0)(18,M,1,0),a()()(),r(19,"div",1)(20,"div",2),c(21,"div",3)(22,"div",3)(23,"div",3),a(),r(24,"h1",4),s(25,"Verify Code"),a(),r(26,"p",5),s(27," Please enter the code sent to your email. "),a(),r(28,"form",6),h("ngSubmit",function(){return e.handleFPsubmit()}),r(29,"div",7),c(30,"input",12),d(31,j,3,1,"div",9),r(32,"label",13),s(33,"Enter code"),a()(),r(34,"button",11),d(35,W,1,0)(36,Z,1,0),a()()(),r(37,"div",1)(38,"div",2),c(39,"div",3)(40,"div",3)(41,"div",3),a(),r(42,"h1",4),s(43,"Set Password"),a(),r(44,"p",5),s(45," Please enter your new password. "),a(),r(46,"form",6),h("ngSubmit",function(){return e.handleEnd()}),r(47,"div",14),c(48,"input",15),r(49,"label",10),s(50,"Email address"),a()(),r(51,"div",7),c(52,"input",16),d(53,H,3,1,"div",9),r(54,"label",17),s(55,"New password"),a()(),r(56,"button",11),d(57,J,1,0)(58,K,1,0),a()()()()),n&2){let f,w,b;i(),l("!block",e.step===1),i(2),l("!bg-main",e.step>=1),i(),l("!bg-main",e.step>=2),i(),l("!bg-main",e.step>=3),i(5),u("formGroup",e.forgetPasswordGroup),i(3),m((f=e.forgetPasswordGroup.get("email"))!=null&&f.touched&&((f=e.forgetPasswordGroup.get("email"))!=null&&f.errors)?13:-1),i(3),u("disabled",e.isLoading),i(),m(e.isLoading?17:18),i(2),l("!block",e.step===2),i(2),l("!bg-main",e.step>=1),i(),l("!bg-main",e.step>=2),i(),l("!bg-main",e.step>=3),i(5),u("formGroup",e.verifyCodeGroup),i(3),m((w=e.verifyCodeGroup.get("resetCode"))!=null&&w.touched&&((w=e.verifyCodeGroup.get("resetCode"))!=null&&w.errors)?31:-1),i(3),u("disabled",e.isLoading),i(),m(e.isLoading?35:36),i(2),l("!block",e.step===3),i(2),l("!bg-main",e.step>=1),i(),l("!bg-main",e.step>=2),i(),l("!bg-main",e.step>=3),i(5),u("formGroup",e.setPasswordGroup),i(2),u("readonly",!0),i(5),m((b=e.setPasswordGroup.get("newPassword"))!=null&&b.touched&&((b=e.setPasswordGroup.get("newPassword"))!=null&&b.errors)?53:-1),i(3),u("disabled",e.isLoading),i(),m(e.isLoading?57:58)}},dependencies:[N,T,E,k,G,R,L],encapsulation:2})};export{q as ResetPassword};
